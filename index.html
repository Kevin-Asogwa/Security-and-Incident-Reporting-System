<!-- This is the HTML file for the home page -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>UNN Security and Incident Reporting System</title>
    <!-- Link to the external CSS file -->
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.15.4/css/all.css"
    />
    <link rel="stylesheet" href="fontawesome/css/fontawesome.css">
    <link rel="stylesheet" href="fontawesome/css/brands.css">
    <link rel="stylesheet" href="fontawesome/css/solid.css">
   >
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <!-- Header section with logo and navigation bar -->
    <header class="header">
      <div class="container">
        <!-- Logo with link to the home page -->
        <a href="#" class="logo">
          <img src="img/logo.jpg" alt="UNN Logo" />
          <span>UNN Security and Incident Reporting System</span>
        </a>
        <!-- Navigation bar with links to other pages -->
        <nav class="nav">
          <ul>
            <li><a href="#" class="active">Home</a></li>
            <li><a href="#">About</a></li>
            <li><a href="#">Contact</a></li>
            <li><a href="#">Login</a></li>
          </ul>
        </nav>
      </div>
      <div class="bg">
        <img src="img/bg1.avif" alt="" />
      </div>
    </header>

    <!-- Main section with introduction and button -->
    <main class="main">
      <div class="container">
        <!-- Introduction with heading and paragraph -->
        <div class="intro">
          <h1>Welcome to the Security and Incident Reporting System</h1>
          <p>
            This system allows you to report any emergency, crime, or incident
            that you witness or experience on or off campus, using your
            smartphone, tablet, or computer. You can also receive feedback and
            updates from the security department and other authorities, as well
            as request or access additional support or assistance.
          </p>
          <!-- Button with link to the report page -->
          <a href="#" class="btn">Report Now</a>
        </div>
      </div>
    </main>
    <!-- Footer section with copyright and social media links -->
    <footer class="footer">
      <div class="container">
        <!-- Copyrigth with year and name -->
        <p>
          &copy; 2024 Security and Incident Reporting System. All rights
          reserved.
        </p>
        <!-- Social media links with icons -->
        <div class="social">
          <a href="#"><i class="fab fa-facebook-f"></i></a>
          <a href="#"><i class="fab fa-twitter"></i></a>
          <a href="#"><i class="fab fa-instagram"></i></a>
          <a href="#"><i class="fab fa-linkedin-in"></i></a>
        </div>
      </div>
    </footer>
  </body>
</html>

<!-- Include the footer.php file -->
<?php include 'components/footer.php'; ?>

<!-- PHP code for the login logic -->
<?php
// Start a session
session_start();

// Include the database connection file
include "db.php";

// Check if the login form is submitted
if (isset($_POST['login'])) {
    // Get the username and password from the form
    $username = $_POST['username'];
    $password = $_POST['password'];

    // Validate the input
    if (empty($username) || empty($password)) {
        // Display an error message if any field is empty
        echo "<script>alert('Please fill in all fields');</script>";
    } else {
        // Prepare a SQL statement to select the user from the database
        $sql = "SELECT * FROM users WHERE username = ?";

        // Create a prepared statement
        $stmt = $conn->prepare($sql);

        // Bind the username parameter to the statement
        $stmt->bind_param("s", $username);

        // Execute the statement
        $stmt->execute();

        // Get the result from the statement
        $result = $stmt->get_result();

        // Check if the user exists in the database
        if ($result->num_rows > 0) {
            // Fetch the user data as an associative array
            $user = $result->fetch_assoc();

            // Verify the password using the hashed password in the database
            if (password_verify($password, $user['password'])) {
                // Set the session variables with the user data
                $_SESSION['user_id'] = $user['id'];
                $_SESSION['user_name'] = $user['name'];
                $_SESSION['user_email'] = $user['email'];

                // Redirect to the welcome page
                header("Location: welcome.php");
            } else {
                // Display an error message if the password is incorrect
                echo "<script>alert('Incorrect password');</script>";
            }
        } else {
            // Display an error message if the user does not exist
            echo "<script>alert('User not found');</script>";
        }

        // Close the statement
        $stmt->close();
    }
}

// Close the database connection
$conn->close();
?> 